"use strict";!function(a){var e,o,n,i,s=1e3*ina_ajax.settings.timeout,r=0,c=10,l=ina_ajax.ajaxurl,u={onReady:function(){this.setupDOM(),this.eventListeners()},setupDOM:function(){},eventListeners:function(){o=sessionStorage.inactive_logout_tabID&&"2"!==sessionStorage.closedLastTab?sessionStorage.inactive_logout_tabID:sessionStorage.inactive_logout_tabID=Math.random(),sessionStorage.closedLastTab="2",window.addEventListener("beforeunload",function(t){sessionStorage.closedLastTab="1"}),localStorage.setItem("ina__browserTabID",o),a(document).on("mousemove",this.resetTimer.bind(this)),a(document).on("mousedown",this.resetTimer.bind(this)),a(document).on("keydown",this.resetTimer.bind(this)),a(document).on("DOMMouseScroll",this.resetTimer.bind(this)),a(document).on("mousewheel",this.resetTimer.bind(this)),a(document).on("touchmove",this.resetTimer.bind(this)),a(document).on("MSPointerMove",this.resetTimer.bind(this)),a(document).ready(this.resetTimer.bind(this)),a(document).on("click",".ina_stay_logged_in",this.stayLoggedInWarnMsg),a(document).on("click",".btn-close-without-reload",this.stayLoggedInWarnMsg),this.startTimer()},startTimer:function(){e=setTimeout(u.goInactive.bind(this),2e3)},resetTimer:function(){clearTimeout(e),clearTimeout(n),localStorage.setItem("ina__browserTabID",o);try{this.startTimer()}catch(t){TypeError,console.log(t,!0)}},goInactive:function(){var t,e=this;0===r&&(t=localStorage.getItem("ina__browserTabID"),parseFloat(t)===parseFloat(o)&&(t=Date.now(),t=Math.floor(t/1e3),t={action:"ina_checklastSession",do:"ina_updateLastSession",security:ina_ajax.ina_security,timestamp:t},a.post(l,t).done(function(t){if(!1!==t.success){var o=document.activeElement;if(o&&("IFRAME"===o.tagName||o.classList.contains("media-modal")))return e.resetTimer(),!1;n=setTimeout(function(){u.showTimeoutMessage(t)},s)}})))},showTimeoutMessage:function(e){var o,t=ina_ajax.settings.disable_countdown,n=ina_ajax.settings.warn_message_enabled;document.onkeydown=function(t){if(116!=(t.charCode||t.keyCode))return!1},window.oncontextmenu=function(){return!1},r=1,n?a("#ina__dp_logout_message_box").show().html(e.html):t?(t={action:"ina_checklastSession",do:"ina_logout",security:ina_ajax.ina_security},a.post(l,t).done(function(t){var o;return t.redirect_url?(a("#ina__dp_logout_message_box").show().html(e.html),a("#ina__dp_logout_message_box .ina-dp-noflict-modal-body").html("<p>"+t.msg+"<p>"),u.logout_now(t.redirect_url)):(o=ina_ajax.is_admin?'<a class="btn-close-without-reload" style="margin-left:10px;" href="javascript:void(0);">'+ina_ajax.i10n.close+"</a>":"",a("#ina__dp_logout_message_box").show().html(e.html),a("#ina__dp_logout_message_box .ina-dp-noflict-modal-body").html("<p>"+t.msg+'</p><p class="ina-dp-noflict-btn-container"><a class="btn-timeout" href="javascript:void(0);" onclick="window.location.reload();">'+ina_ajax.i10n.ok+"</a>"+o+"</p>"),u.logout_now(!1)),!1})):(c=10,a("#ina__dp_logout_message_box").show().html(e.html),i=setInterval(function(){var t;0<=c&&(o=c--,a(".ina_countdown").html("("+o+")")),0===o&&(clearTimeout(i),t={action:"ina_checklastSession",do:"ina_logout",security:ina_ajax.ina_security},a.post(l,t).done(function(t){var o;return t.redirect_url?(a("#ina__dp_logout_message_box .ina-dp-noflict-modal-body").html("<p>"+t.msg+"<p>"),u.logout_now(t.redirect_url)):(o=ina_ajax.is_admin?'<a class="btn-close-without-reload" style="margin-left:10px;" href="javascript:void(0);">'+ina_ajax.i10n.close+"</a>":"",a("#ina__dp_logout_message_box .ina-dp-noflict-modal-body").html("<p>"+t.msg+'</p><p class="ina-dp-noflict-btn-container"><a class="btn-timeout" href="javascript:void(0);" onclick="window.location.reload();">'+ina_ajax.i10n.ok+"</a>"+o+"</p>"),u.logout_now(!1)),!1}))},1e3))},stayLoggedInWarnMsg:function(){document.onkeydown=function(t){return!0},window.oncontextmenu=null,clearTimeout(i),c=10,r=0,a("#ina__dp_logout_message_box").hide(),a(".ina_countdown").text("")},logout_now:function(t){var o={action:"ina_logout_session",security:ina_ajax.ina_security};a.post(l,o).done(function(){clearTimeout(e),localStorage.removeItem("ina__browserTabID"),t&&(window.location=t),ina_ajax.is_admin&&a(document).trigger("heartbeat-tick.wp-auth-check",[{"wp-auth-check":!1}]),console.log("Session Logged Out !!")})}};a(function(){u.onReady()})}(jQuery);